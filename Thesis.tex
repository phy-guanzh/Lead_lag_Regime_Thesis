%% ----------------------------------------------------------------
%% Thesis.tex
%% ---------------------------------------------------------------- 
\documentclass{ecsthesis}      % Use the Thesis Style
\graphicspath{{../Figures/}}   % Location of your graphics files
\usepackage{natbib}   
\usepackage{pdfpages}         % Use Natbib style for the refs.
\usepackage{enumitem} 
\usepackage{algpseudocode}
\newcommand{\params}[2]{$n_{\text{steps}}=#1,\ n_{\text{paths}}=#2$}
\usepackage[ruled,vlined]{algorithm2e}
\DontPrintSemicolon
\LinesNumberedHidden
\SetKwInOut{Input}{Input}
\SetKwInOut{Params}{Params}
\SetKwInOut{Output}{Output}

\hypersetup{colorlinks=false}   % Set to false for black/white printing
\input{Definitions}            % Include your abbreviations

%% ----------------------------------------------------------------
\begin{document}
\frontmatter
\title      {Signature-Kernel Regime Detection and a Regime-Aware Lead–Lag Overlay}
\addresses  {\groupname {Faculty of Social Sciences}\\
	         \deptname {Mathematics School}\\ 
	         \univname {University of Southampton}}

\authors    {\texorpdfstring
{\href{}{Zhe GUAN}}
{3-36516473}
}
\date       {\today}
\supervisor {Sasan Barak}
\examiner {}

\subject    {Mathemetics}
\keywords   {}
\maketitle
\begin{abstract}

This dissertation studies lead--lag structure in the cryptocurrency market and its use for return prediction and portfolio construction. Rolling directed lead--lag matrices are built with a signature (sequence–kernel) estimator on 30 business–day windows (update every day, maximum lag 7) after winsorizing daily returns at the 2.5/97.5\% tails. A baseline long–short hedge goes long “followers” and short “leaders” identified by row–mean scores. A strict walk–forward regime detector is then introduced: Bitcoin path groups are compared using a signature–kernel MMD distance, clustered on historical data under a visibility constraint, mapped to bear/neutral/bull, and compressed to a daily regime by a rolling vote. The trading overlay conditions the baseline by the sign of each asset’s relation to the anchor and applies a fixed neutral scaling ($\alpha=0.5$) while preserving the baseline hedge.

The dataset contains daily closes for 72 Binance–listed assets from 2021-01 to 2024-06. At the same time–in–market (43\%), the regime overlay improves headline performance relative to the baseline: cumulative return 132.8\% vs.\ 59.5\%, CAGR 31.4\% vs.\ 16.3\%, Sharpe 1.46 vs.\ 0.58, annualized volatility 20.1\% vs.\ 38.1\%, and maximum drawdown $-14.2\%$ vs.\ $-35.3\%$ (pre–costs). It outperforms in three of four calendar years and turns a negative 2023 baseline (-5.42\%) into a positive outcome (+7.79\%). Robustness checks across estimator variants and parameter settings indicate stable signals; performance declines when detection and rebalancing are less frequent, consistent with slow information diffusion. Data–driven leaders and followers show limited overlap with size/volume rankings, suggesting the structure is not a capitalization effect.

\textbf{Keywords:} lead--lag, return prediction, portfolio construction, regime detection, signature kernel, MMD, cryptocurrencies.

\iffalse
 This project builds and tests a market-neutral trading strategy that uses lead–lag relationships between cryptocurrencies.

 We generate rolling lead–lag matrices with different methods — Pearson correlation, distance correlation, and path signature — to see how well each one picks up directional influence between assets.
Among these, the signature-based method stands out for being more responsive to changing relationships, especially in volatile markets.

To make the strategy adapt to market conditions, we add a regime detection step that clusters sliding price segments into bull, bear, or neutral regimes, without using any future data.
This regime signal is then used to change how the strategy goes long and short depending on the market state.

Backtests on a basket of popular cryptocurrencies from January 2021 to June 2024 show that adding the regime signal improves results for all the lead–lag methods, with a clear boost in risk-adjusted returns when BTC is included.

We also run sensitivity checks, add a basic benchmark strategy for comparison, and keep the code modular for easy reuse.
\fi

\end{abstract}
\acknowledgements{Completing this master’s dissertation has been both an academic challenge and a personal milestone. Coming from a physics background, taking a first step into data–driven finance has felt like a small but meaningful achievement. I am grateful to everyone who helped make that transition possible.

I would like to express my sincere thanks to my supervisor, \textbf{Dr.\ Sasan Barak}, for clear guidance, steady support, and timely, constructive feedback at every stage. His encouragement to test ideas rigorously and try new methods helped me navigate the technical parts of this project and sharpen my analytical thinking.

I am deeply thankful to my parents for giving me the opportunity to study in the UK and for their constant support, both practical and emotional. 

Finally, thank you to my friends in Southampton for the long study sessions, dissertation discussions, and all the small moments that made this year memorable. Any remaining errors are my own.}
\includepdf[offset=25mm -30mm]{soo.pdf}
\tableofcontents
\listoffigures
\listoftables
\lstlistoflistings
%\listofsymbols{|l|l|}{
%BTC & Bitcoin \\
%S\&P &Standard \& Poor’s 500 Index
%\\$w$ & The weight vector}
\listofsymbols{|l|l|}{
AMH & Adaptive Markets Hypothesis \\
EMH & Efficient Market Hypothesis \\
TSMOM & Time-Series Momentum \\
FX & Foreign Exchange \\
RCM & Regime Classification Measure \\
DGP & Data-Generating Process \\
ARCH & Autoregressive Conditional Heteroskedasticity \\
GARCH & Generalized ARCH \\
SWARCH & Markov-Switching ARCH \\
NYSE & New York Stock Exchange \\
S\&P 500 & Standard \& Poor’s 500 Index \\
S\&P Composite & Standard \& Poor’s Composite Index \\
FTSE 100 & Financial Times Stock Exchange 100 Index \\
CAC 40 & Cotation Assistée en Continu 40 (French equity index) \\
ECM & Error-Correction Model \\
COC & Cost of Carry \\
ECM-COC & Error-Correction Model with Cost of Carry \\
ARMA & Autoregressive Moving-Average \\
VAR & Vector Autoregression \\
RMSE & Root Mean Squared Error \\
MAE & Mean Absolute Error \\
LLR & Lead–Lag Ratio \\
HY & Hayashi–Yoshida (estimator / cross-correlation) \\
CET & Central European Time \\
CAPM & Capital Asset Pricing Model \\
FF3 & Fama–French Three-Factor Model \\
FF5 & Fama–French Five-Factor Model \\
SBM & Stochastic Block Model \\
DI\text{-}SIM & Directed Spectral Clustering method (DI-SIM) \\
CCF & Cross-Correlation Function \\
AUC & Area Under the Curve \\
ARI & Adjusted Rand Index \\
MI & Mutual Information
BTC & Bitcoin (anchor asset)\\
WF & Walk–forward (rolling forward)\\
MMD & Maximum Mean Discrepancy\\
RBF & Radial Basis Function\\
NaN & Not a Number (missing value)\\
Inf & Infinity\\
bdays & Business days\\
$z_t$ & Daily market regime label (0=bear, 1=neutral, 2=bull)\\
$p_\tau$ & BTC close price at time $\tau$\\
$\gamma$ & Path embedding $\{(\tau,p_\tau)\}$\\
$\widehat\gamma$ & Transformed path $T(\gamma)$\\
$T$ & Path transformer (level standardization, time normalization)\\
$n_{\text{steps}}$ & Subpath length (number of steps)\\
$n_{\text{paths}}$ & Number of subpaths per group\\
$o$ & Overlap offset in subpath stride\\
$G_g$ & The $g$-th path group\\
$[s_g,e_g]$ & Calendar span covered by group $G_g$\\
$K_\Sigma$ & Signature kernel\\
$\Phi(\cdot)$ & Feature map induced by $K_\Sigma$\\
$\sigma$ & RBF bandwidth\\
$d$ & Dyadic order\\
$\lambda$ & Regularization parameter\\
$D_{g,h}$ & Group distance $\mathrm{MMD}(G_g,G_h)$\\
$D$ & Precomputed distance matrix $\in\mathbb{R}^{G\times G}$\\
$w$ & WF history window length (in groups)\\
$H$ & Forward horizon (days)\\
$n_c$ & Number of clusters\\
$\tau_{+},\tau_{-}$ & Thresholds for semantic mapping (bull/bear)\\
$E_g$ & Eligible history set at decision $g$\\
$m_c$ & Medoid of cluster $c$\\
$\mu_c$ & Mean $H$-day forward return of cluster $c$\\
$\psi(\cdot)$ & Mapping from cluster to \{bear, neutral, bull\}\\
$\mathrm{dir\_label}_g$ & Directional label of group $G_g$ ($\in\{0,1,2\}$)\\
$k$ & Count parameter: daily voting window size / minimum names (context-dependent)\\
$L$ & Rolling window length (bdays)\\
$f$ & Update/rebalance spacing (bdays)\\
$\ell_{\max}$ & Maximum forward lag\\
$m$ & Signature truncation order\\
$\mathcal{T}$ & Set of update dates\\
$N$ & Number of assets\\
$P_{i,t}$ & Close price of asset $i$ on day $t$\\
$r_{i,t}$ & Log return of asset $i$ on day $t$\\
$M_t$ & Signature-based lead–lag directed matrix at date $t$\\
$x^{(t,\ell)}_{i}$ & Past sequence of $i$ on $W_t$ (aligned to $j$’s future)\\
$y^{(t,\ell)}_{j}$ & Future sequence of $j$ on $W_t$ (shifted by $\ell$)\\
$\Phi_m(\cdot)$ & Signature feature vector up to order $m$\\
$\widehat\Phi_m(\cdot)$ & Normalized signature features\\
$s^{(\ell)}_{ij}(t)$ & Directional similarity score (“$i$ then $j$” minus “$j$ then $i$”)\\
$\ell^\star_{ij}(t)$ & Lag maximizing $|s^{(\ell)}_{ij}(t)|$\\
$s_t(i)$ & Row-mean leadership score of asset $i$\\
$\mathcal{L}_t,\ \mathcal{F}_t$ & Leaders / followers sets (by quantiles)\\
$Q_q(\cdot)$ & Quantile operator (the $q$-quantile)\\
$w_{t^+}(i)$ & Portfolio weight of asset $i$ executed on $t^+$\\
$R_{t^+}$ & Baseline strategy daily return realized on $t^+$\\
$a$ & Anchor asset (here $a=\mathrm{BTC}$)\\
$\mathrm{rel}_t(i)$ & Signed anchor relation for asset $i$ (from $M_t$)\\
$\mathcal{B}^{\mathrm{long}},\ \mathcal{B}^{\mathrm{short}}$ & Long / short baskets\\
$\mathcal{F}_t^{+},\ \mathcal{F}_t^{-}$ & Followers with $\mathrm{rel}_t(i)>0$ / $<0$\\
$\mathcal{L}_t^{+},\ \mathcal{L}_t^{-}$ & Leaders with $\mathrm{rel}_t(i)>0$ / $<0$\\
$R^{\mathrm{overlay}}_{t^+}$ & Regime-aware overlay daily return\\
$\alpha$ & Neutral-period scaling coefficient (set to $0.5$)\\
$\overline{r}_{\mathcal{B},\,t^+}$ & Average return of basket $\mathcal{B}$ on $t^+$\\
$t^+$ & Next trading day (relative to update date $t$)\\
$\mathcal{U}$ & Investable universe / tradable asset set
}

\mainmatter
%% ----------------------------------------------------------------
\include{Introduction}
\include{Literature}
\include{Methodology}
\include{Results}
\include{Discussion}
\include{Concusion}
\appendix
\include{AppendixA}
\backmatter
\bibliographystyle{ecs}
\bibliography{ECS}
\end{document}
%% ----------------------------------------------------------------
